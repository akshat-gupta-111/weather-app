<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Data Visual Explorer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
</head>
<body>
    <header class="header">
        <div class="container">
            <h1 class="logo">TempTrack</h1>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- Location Selection Panel -->
            <section class="location-selection">
                <div class="search-globe-container">
                    <!-- Search Bar -->
                    <div class="search-section">
                        <div class="search-container">
                            <input type="text" id="citySearch" placeholder="üîç Search for a city..." autocomplete="off">
                            <div id="searchResults" class="search-results"></div>
                        </div>
                    </div>
                    
                    <!-- Globe -->
                    <div class="globe-section">
                        <div id="earth-container" class="globe-container">
                            <div id="earth">
                                <div id="earth-map"></div>
                            </div>
                            <div id="tooltip"></div>
                        </div>
                        <p class="help-text">Drag to rotate ‚Ä¢ Click to select ‚Ä¢ Double-click to zoom</p>
                    </div>
                </div>
                
                <!-- Map -->
                <div class="map-section">
                    <div id="map" class="map-container"></div>
                    <p class="help-text">Click on the map to select a location</p>
                </div>
            </section>

            <!-- Loading State -->
            <div id="loadingState" class="loading-state hidden">
                <div class="loading-spinner"></div>
                <p>Loading climate data...</p>
            </div>

            <!-- Dashboard -->
            <div id="dashboard" class="dashboard hidden">
                <!-- Location Info -->
                <div class="location-info">
                    <h2 id="locationName">Select a location to view climate data</h2>
                    <span id="coordinates" class="coordinates"></span>
                </div>

                <!-- Time Period Navigation -->
                <nav class="time-nav">
                    <button class="time-btn active" data-period="today">Today</button>
                    <button class="time-btn" data-period="7days">Last 7 Days</button>
                    <button class="time-btn" data-period="30days">Last 30 Days</button>
                </nav>

                <!-- Current Conditions (Only for Today) -->
                <div id="currentConditions" class="current-conditions">
                    <div class="current-grid">
                        <div class="current-card temperature">
                            <div class="card-icon">üå°Ô∏è</div>
                            <div class="card-content">
                                <span class="card-value" id="currentTemp">--</span>
                                <span class="card-unit">¬∞C</span>
                                <span class="card-label">Temperature</span>
                            </div>
                        </div>
                        
                        <div class="current-card humidity">
                            <div class="card-icon">üíß</div>
                            <div class="card-content">
                                <span class="card-value" id="currentHumidity">--</span>
                                <span class="card-unit">%</span>
                                <span class="card-label">Humidity</span>
                            </div>
                        </div>
                        
                        <div class="current-card air-quality">
                            <div class="card-icon">üå¨Ô∏è</div>
                            <div class="card-content">
                                <span class="card-value" id="currentPM25">--</span>
                                <span class="card-unit">Œºg/m¬≥</span>
                                <span class="card-label">PM2.5</span>
                            </div>
                        </div>
                        
                        <div class="current-card wind">
                            <div class="card-icon">üí®</div>
                            <div class="card-content">
                                <span class="card-value" id="currentWind">--</span>
                                <span class="card-unit">km/h</span>
                                <span class="card-label">Wind Speed</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3 id="tempChartTitle">Temperature</h3>
                        <div class="chart-container">
                            <canvas id="temperatureChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3 id="precipChartTitle">Rainfall</h3>
                        <div class="chart-container">
                            <canvas id="precipitationChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3 id="airChartTitle">Air Quality</h3>
                        <div class="chart-container">
                            <canvas id="airQualityChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card full-width">
                        <h3 id="heatmapTitle">Air Quality Heatmap</h3>
                        <div class="heatmap-container">
                            <canvas id="heatmapChart"></canvas>
                        </div>
                        <!-- Custom Legend Container -->
                        <div id="heatmapLegend" class="heatmap-legend-container"></div>
                    </div>
                </div>

                <!-- AI Climate Assistant -->
                <div class="chat-section">
                    <div class="chat-card">
                        <h3>ü§ñ Climate Data Assistant</h3>
                        <div id="chatContainer" class="chat-container">
                            <div id="chatMessages" class="chat-messages">
                                <div class="chat-message bot-message">
                                    <div class="message-content">
                                        üëã Hi! I'm your Climate Data Assistant. Ask me anything about the weather data, air quality, or trends shown in your dashboard!
                                    </div>
                                </div>
                            </div>
                            <div class="chat-input-container">
                                <input type="text" id="chatInput" placeholder="Ask about temperature, air quality, weather trends..." maxlength="500">
                                <button id="sendChatBtn" class="send-btn">
                                    <span>Send</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Climate Data Visual Explorer | Data from Open-Meteo & OpenWeatherMap</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>